nutrient.data[["quinoa"]]
library(lattice)
library(ggplot2)
library(knitr)
plot(rnorm(1,2))
plot(rnorm(100,1,2))
library(rpubs)
install.packages('knitr')
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
dge.glm
library(edgeR)
dat <- read.table("bottomly_count_table.tsv", header = TRUE,
row.names = 1)
des <- read.table("bottomly_phenodata.tsv", header = TRUE,
row.names = 1)
all(rownames(des) == colnames(dat))
table(des$strain)
group <- factor(c(rep("1", 10), rep("2", 11)))
dge.glm <- DGEList(counts = dat, group = group)
setwd()
getwd()
setwd("stat540-2014-hindalong-emily/sem07")
library(edgeR)
dat <- read.table("bottomly_count_table.tsv", header = TRUE,
row.names = 1)
des <- read.table("bottomly_phenodata.tsv", header = TRUE,
row.names = 1)
all(rownames(des) == colnames(dat))
table(des$strain)
group <- factor(c(rep("1", 10), rep("2", 11)))
dge.glm <- DGEList(counts = dat, group = group)
str(dge.glm)
dge.glm
keeps <- lapply(dat,function(x) {sum(x) > 0})
keeps
str(dat)
keeps <- apply(dat,1,function(x) {sum(x) > 0})
datFilt <- dat[keeps,]
head(dat)
dge.glm <- DGEList(counts = datFilt, group = group)
str(dge.glm)
design <- model.matrix(~group)
dge.glm.com.disp <- estimateGLMCommonDisp(dge.glm, design, verbose = TRUE)
dge.glm.com.disp <- estimateGLMCommonDisp(dge.glm, design, verbose = TRUE)
dge.glm.trend.disp <- estimateGLMTrendedDisp(dge.glm.com.disp)
dge.glm.tag.disp <- estimateGLMTagwiseDisp(dge.glm.trend.disp, design)
plotBCV(dge.glm.tag.disp)
fit <- glmFit(dge.glm.tag.disp, design)
colnames(coef(fit))
lrt <- glmLRT(fit, coef = 2)
topTags(lrt)
dge.glm <- DGEList(counts = dat, group = group)
str(dge.glm)
design <- model.matrix(~group)
dge.glm.com.disp <- estimateGLMCommonDisp(dge.glm, design, verbose = TRUE)
dge.glm.trend.disp <- estimateGLMTrendedDisp(dge.glm.com.disp)
dge.glm.tag.disp <- estimateGLMTagwiseDisp(dge.glm.trend.disp, design)
plotBCV(dge.glm.tag.disp)
dge.glm <- DGEList(counts = dat, group = group)
dge.glm.tag.disp <- estimateGLMTagwiseDisp(dge.glm.trend.disp, design)
plotBCV(dge.glm.tag.disp)
fit <- glmFit(dge.glm.tag.disp, design)
colnames(coef(fit))
lrt <- glmLRT(fit, coef = 2)
topTags(lrt)
deSeqDat <- newCountDataSet(dat, group)
head(counts(deSeqDat))
library(DESeq)
biocLite("DESeq")
source("http://www.bioconductor.org/biocLite.R")
biocLite("DESeq")
library(DESeq)
deSeqDat <- newCountDataSet(dat, group)
head(counts(deSeqDat))
deSeqDat <- estimateSizeFactors(deSeqDat)
sizeFactors(deSeqDat)
deSeqDat <- estimateDispersions(deSeqDat)
plotDispEsts(deSeqDat)
results <- nbinomTest(deSeqDat, levels(group)[1], levels(group)[2])
str(results)
library(limma)
norm.factor <- calcNormFactors(dat)
dat.voomed <- voom(dat, design, plot = TRUE, lib.size = colSums(dat) * norm.factor)
dat.voomed
